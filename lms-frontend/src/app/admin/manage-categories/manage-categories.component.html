<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Quản lý Danh mục</h2>
    <a class="btn btn-outline-secondary" routerLink="/books"><i class="fa-solid fa-arrow-left"></i> Quay lại danh sách sách</a>
  </div>

  <div class="input-group mb-3">
    <span class="input-group-text"><i class="fa-solid fa-search"></i></span>
    <input class="form-control" [(ngModel)]="search" placeholder="Tìm theo tên..." />
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-6">
          <label class="form-label">Thêm danh mục mới</label>
          <input class="form-control" [(ngModel)]="newName" placeholder="Tên danh mục" />
        </div>
        <div class="col-md-3">
          <button class="btn btn-success" (click)="create()">Tạo</button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="isLoading" class="text-muted">Đang tải...</div>

  <table class="table" *ngIf="!isLoading">
    <thead>
      <tr>
        <th style="width:80px">ID</th>
        <th>Tên</th>
        <th style="width:220px">Hành động</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of filtered()">
        <td>{{ c.id }}</td>
        <td>
          <ng-container *ngIf="!editing || editing.id !== c.id; else editTpl">
            {{ c.name }}
          </ng-container>
          <ng-template #editTpl>
            <input class="form-control" [(ngModel)]="editing!.name" />
          </ng-template>
        </td>
        <td>
          <ng-container *ngIf="!editing || editing.id !== c.id; else editingBtns">
            <button class="btn btn-sm btn-primary me-2" (click)="startEdit(c)"><i class="fa-solid fa-pen"></i> Sửa</button>
            <button class="btn btn-sm btn-danger" (click)="remove(c.id)"><i class="fa-solid fa-trash"></i> Xóa</button>
          </ng-container>
          <ng-template #editingBtns>
            <button class="btn btn-sm btn-success me-2" (click)="saveEdit()"><i class="fa-solid fa-check"></i> Lưu</button>
            <button class="btn btn-sm btn-secondary" (click)="cancelEdit()"><i class="fa-solid fa-xmark"></i> Huỷ</button>
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>
</div>
